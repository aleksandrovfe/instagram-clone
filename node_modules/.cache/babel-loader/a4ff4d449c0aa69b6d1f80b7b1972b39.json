{"ast":null,"code":"import _slicedToArray from\"/Users/aleksandrov/WebstormProjects/instagram/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import Input from\"@material-ui/core/Input\";import Button from\"@material-ui/core/Button\";import{db,storage}from\"./firebase\";import firebase from\"firebase\";export var ImageUploader=function ImageUploader(_ref){var setOpenNewpost=_ref.setOpenNewpost,userName=_ref.userName;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),caption=_useState2[0],setCaption=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var handleChange=function handleChange(event){if(event.target.files[0]){setImage(event.target.files[0]);}};var handleUpload=function handleUpload(){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on('state_changed',function(snapshot){var progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){return console.log(error);},function(){storage.ref('images').child(image.name).getDownloadURL().then(function(url){db.collection('posts').add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,ImageUrl:url,userName:userName});setProgress(0);setCaption('');setImage(null);});});setOpenNewpost(false);};return/*#__PURE__*/React.createElement(\"div\",{className:\"uploader\"},/*#__PURE__*/React.createElement(\"div\",{className:\"uploader__wrapper\"},/*#__PURE__*/React.createElement(Input,{type:\"text\",placeholder:\"Enter a caption...\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption,className:\"uploader__item uploader__caption\"}),/*#__PURE__*/React.createElement(Input,{className:\"uploader__item\",type:\"file\",onChange:handleChange}),/*#__PURE__*/React.createElement(Button,{className:\"uploader__item\",onClick:handleUpload},\"Upload\")),/*#__PURE__*/React.createElement(\"progress\",{className:\"uploader__progress\",value:progress,max:\"100\"}));};","map":{"version":3,"sources":["/Users/aleksandrov/WebstormProjects/instagram/src/ImageUpload.jsx"],"names":["React","useState","Input","Button","db","storage","firebase","ImageUploader","setOpenNewpost","userName","caption","setCaption","image","setImage","progress","setProgress","handleChange","event","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","ImageUrl","value"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\nimport Input from \"@material-ui/core/Input\";\nimport Button from \"@material-ui/core/Button\";\nimport {db, storage} from \"./firebase\";\nimport firebase from \"firebase\";\n\nexport const ImageUploader = ({setOpenNewpost, userName}) => {\n    const [caption, setCaption] = useState('')\n    const [image, setImage] = useState('')\n    const [progress, setProgress] = useState(0)\n\n    const handleChange = (event) => {\n        if (event.target.files[0]) {\n            setImage(event.target.files[0])\n        }\n    }\n\n    const handleUpload = () => {\n        const uploadTask = storage.ref(`images/${image.name}`).put(image)\n        uploadTask.on(\n            'state_changed',\n            snapshot => {\n                const progress = Math.round(\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n                )\n                setProgress(progress)\n            },\n            error => console.log(error),\n            () => {\n                storage\n                    .ref('images')\n                    .child(image.name)\n                    .getDownloadURL()\n                    .then(url => {\n                        db.collection('posts').add({\n                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n                            caption: caption,\n                            ImageUrl: url,\n                            userName: userName,\n                        })\n                        setProgress(0)\n                        setCaption('')\n                        setImage(null)\n                    })\n            }\n        )\n        setOpenNewpost(false)\n    }\n\n    return (\n        <div className=\"uploader\">\n            <div className='uploader__wrapper'>\n                <Input\n                    type=\"text\"\n                    placeholder=\"Enter a caption...\"\n                    onChange={event => setCaption(event.target.value)}\n                    value={caption}\n                    className=\"uploader__item uploader__caption\"\n                />\n                <Input className=\"uploader__item\" type=\"file\" onChange={handleChange}/>\n                <Button className=\"uploader__item\" onClick={handleUpload}>Upload</Button>\n            </div>\n            <progress className=\"uploader__progress\" value={progress} max='100'></progress>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}